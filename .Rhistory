pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
node = "0lll"
indices <- getIndices(mvTree.dist$trees[[1]], node)
indices <- getIndices(mvTree.dist$trees[[1]], node)
getIndices <- function(.NODE, .position){
if(nchar(.position) == 1){
if(.NODE$isLeaf == 1){
return(list(centerInd = .NODE$indices + 1))
} else {
return(list(leftInd  = .NODE$left$indices + 1,
rightInd = .NODE$right$indices + 1))
}
} else {
if(substr(.position, 2, 2) == "r"){
.getIndices(.NODE$right, substr(.position,2, nchar(.position)))
} else {
.getIndices(.NODE$left, substr(.position,2, nchar(.position)))
}
}
}
node = "0"
indices <- getIndices(mvTree.dist$trees[[1]], node)
node = "0l"
indices <- getIndices(mvTree.dist$trees[[1]], node)
debug(getIndices)
getIndices <- function(.NODE, .position){
if(nchar(.position) == 1){
if(.NODE$isLeaf == 1){
return(list(centerInd = .NODE$indices + 1))
} else {
return(list(leftInd  = .NODE$left$indices + 1,
rightInd = .NODE$right$indices + 1))
}
} else {
if(substr(.position, 2, 2) == "r"){
getIndices(.NODE$right, substr(.position,2, nchar(.position)))
} else {
getIndices(.NODE$left, substr(.position,2, nchar(.position)))
}
}
}
node = "0l"
indices <- getIndices(mvTree.dist$trees[[1]], node)
node = "0"
png(paste("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/img/splitting_", node,".png", sep=""),
units="in", res=300, width = 12, height=6)
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
node = "0l"
png(paste("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/img/splitting_", node,".png", sep=""),
units="in", res=300, width = 12, height=6)
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
node = "0ll"
png(paste("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/img/splitting_", node,".png", sep=""),
units="in", res=300, width = 12, height=6)
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
node = "0lll"
png(paste("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/img/splitting_", node,".png", sep=""),
units="in", res=300, width = 12, height=6)
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
ggpl <- function(.data, .indices){
.data <- as.data.frame(.data)
colnames(.data) <- 1:ncol(.data)
.data$Time <- 1:nrow(.data)
.data <- melt(.data, id="Time")
.data$colour <- 'black'
.data$colour[.data$variable %in% .indices$leftInd] <- "red"
.data$colour[.data$variable %in% .indices$rightInd] <- "blue"
.data$colour <- factor(.data$colour, levels=c("black","red","blue"))
.order <- c(.data$variable[.data$colour=="black"], .data$variable[.data$colour=="blue"],.data$variable[.data$colour=="red"])
.data$variable <- factor(.data$variable, levels = .order)
pl <- ggplot(.data) + geom_line(aes(x=Time, y=value, group=variable, colour=colour)) +
scale_colour_manual(values=c("black","red","blue")) + guides(colour="none")
return(pl)
}
node = "0ll"
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
ggpl <- function(.data, .indices){
.data <- as.data.frame(.data)
colnames(.data) <- 1:ncol(.data)
.data$Time <- 1:nrow(.data)
.data <- melt(.data, id="Time")
.data$colour <- 'black'
.data$colour[.data$variable %in% .indices$leftInd] <- "red"
.data$colour[.data$variable %in% .indices$rightInd] <- "blue"
.data$colour <- factor(.data$colour, levels=c("black","red","blue"))
.order <- c(.data$variable[.data$colour=="black"], .data$variable[.data$colour=="red"],.data$variable[.data$colour=="blue"])
.data$variable <- factor(.data$variable, levels = .order)
pl <- ggplot(.data) + geom_line(aes(x=Time, y=value, group=variable, colour=colour)) +
scale_colour_manual(values=c("black","red","blue")) + guides(colour="none")
return(pl)
}
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
ggpl <- function(.data, .indices){
.data <- as.data.frame(.data)
colnames(.data) <- 1:ncol(.data)
.data$Time <- 1:nrow(.data)
.data <- melt(.data, id="Time")
.data$colour <- 'black'
.data$colour[.data$variable %in% .indices$leftInd] <- "red"
.data$colour[.data$variable %in% .indices$rightInd] <- "blue"
.data$colour <- factor(.data$colour, levels=c("black","red","blue"))
.order <- c(.data$variable[.data$colour=="black"], .data$variable[.data$colour=="red"],.data$variable[.data$colour=="blue"])
.data$variable <- factor(.data$variable, levels = .order)
.data$width <- 3
.data$width[.data$colour=="black"] <- 1
pl <- ggplot(.data) + geom_line(aes(x=Time, y=value, group=variable, colour=colour)) +
scale_colour_manual(values=c("black","red","blue")) + guides(colour="none")
return(pl)
}
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
ggpl <- function(.data, .indices){
.data <- as.data.frame(.data)
colnames(.data) <- 1:ncol(.data)
.data$Time <- 1:nrow(.data)
.data <- melt(.data, id="Time")
.data$colour <- 'black'
.data$colour[.data$variable %in% .indices$leftInd] <- "red"
.data$colour[.data$variable %in% .indices$rightInd] <- "blue"
.data$colour <- factor(.data$colour, levels=c("black","red","blue"))
.order <- c(.data$variable[.data$colour=="black"], .data$variable[.data$colour=="red"],.data$variable[.data$colour=="blue"])
.data$variable <- factor(.data$variable, levels = .order)
.data$width <- 3
.data$width[.data$colour=="black"] <- 1
pl <- ggplot(.data) + geom_line(aes(x=Time, y=value, group=variable, colour=colour, width=width)) +
scale_colour_manual(values=c("black","red","blue")) + guides(colour="none")
return(pl)
}
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
ggpl <- function(.data, .indices){
.data <- as.data.frame(.data)
colnames(.data) <- 1:ncol(.data)
.data$Time <- 1:nrow(.data)
.data <- melt(.data, id="Time")
.data$colour <- 'black'
.data$colour[.data$variable %in% .indices$leftInd] <- "red"
.data$colour[.data$variable %in% .indices$rightInd] <- "blue"
.data$colour <- factor(.data$colour, levels=c("black","red","blue"))
.order <- c(.data$variable[.data$colour=="black"], .data$variable[.data$colour=="red"],.data$variable[.data$colour=="blue"])
.data$variable <- factor(.data$variable, levels = .order)
.data$width <- 3
.data$width[.data$colour=="black"] <- 1
pl <- ggplot(.data) + geom_line(aes(x=Time, y=value, group=variable, colour=colour, lwd=width)) +
scale_colour_manual(values=c("black","red","blue")) + guides(colour="none")
return(pl)
}
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
ggpl <- function(.data, .indices){
.data <- as.data.frame(.data)
colnames(.data) <- 1:ncol(.data)
.data$Time <- 1:nrow(.data)
.data <- melt(.data, id="Time")
.data$colour <- 'black'
.data$colour[.data$variable %in% .indices$leftInd] <- "red"
.data$colour[.data$variable %in% .indices$rightInd] <- "blue"
.data$colour <- factor(.data$colour, levels=c("black","red","blue"))
.order <- c(.data$variable[.data$colour=="black"], .data$variable[.data$colour=="red"],.data$variable[.data$colour=="blue"])
.data$variable <- factor(.data$variable, levels = .order)
.data$width <- 1.5
.data$width[.data$colour=="black"] <- 1
pl <- ggplot(.data) + geom_line(aes(x=Time, y=value, group=variable, colour=colour, lwd=width)) +
scale_colour_manual(values=c("black","red","blue")) + guides(colour="none", width="none")
return(pl)
}
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
ggpl <- function(.data, .indices){
.data <- as.data.frame(.data)
colnames(.data) <- 1:ncol(.data)
.data$Time <- 1:nrow(.data)
.data <- melt(.data, id="Time")
.data$colour <- 'black'
.data$colour[.data$variable %in% .indices$leftInd] <- "red"
.data$colour[.data$variable %in% .indices$rightInd] <- "blue"
.data$colour <- factor(.data$colour, levels=c("black","red","blue"))
.order <- c(.data$variable[.data$colour=="black"], .data$variable[.data$colour=="red"],.data$variable[.data$colour=="blue"])
.data$variable <- factor(.data$variable, levels = .order)
.data$width <- 1.5
.data$width[.data$colour=="black"] <- 1
pl <- ggplot(.data) + geom_line(aes(x=Time, y=value, group=variable, colour=colour, size=width)) +
scale_colour_manual(values=c("black","red","blue")) + guides(colour="none", width="none")
return(pl)
}
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
ggpl <- function(.data, .indices){
.data <- as.data.frame(.data)
colnames(.data) <- 1:ncol(.data)
.data$Time <- 1:nrow(.data)
.data <- melt(.data, id="Time")
.data$colour <- 'black'
.data$colour[.data$variable %in% .indices$leftInd] <- "red"
.data$colour[.data$variable %in% .indices$rightInd] <- "blue"
.data$colour <- factor(.data$colour, levels=c("black","red","blue"))
.order <- c(.data$variable[.data$colour=="black"], .data$variable[.data$colour=="red"],.data$variable[.data$colour=="blue"])
.data$variable <- factor(.data$variable, levels = .order)
.data$width <- 1.5
.data$width[.data$colour=="black"] <- 1
pl <- ggplot(.data) + geom_line(aes(x=Time, y=value, group=variable, colour=colour, size=width)) +
scale_colour_manual(values=c("black","red","blue")) + guides(colour="none", size="none") +
scale_size_manual(values=c(1,1.5))
return(pl)
}
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
print(pOil)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
print(pOil)
.data <- oilRatesFinal
.data <- oilRatesFinal
.indices <- getIndices(mvTree.dist$trees[[1]], node)
.data <- as.data.frame(.data)
colnames(.data) <- 1:ncol(.data)
.data$Time <- 1:nrow(.data)
.data <- melt(.data, id="Time")
.data$colour <- 'black'
.data$colour[.data$variable %in% .indices$leftInd] <- "red"
.data$colour[.data$variable %in% .indices$rightInd] <- "blue"
.data$colour <- factor(.data$colour, levels=c("black","red","blue"))
.order <- c(.data$variable[.data$colour=="black"], .data$variable[.data$colour=="red"],.data$variable[.data$colour=="blue"])
.data$variable <- factor(.data$variable, levels = .order)
.data$width <- 1.5
.data$width[.data$colour=="black"] <- 1
ggplot(.data) + geom_line(aes(x=Time, y=value, group=variable, colour=colour, size=width)) +
scale_colour_manual(values=c("black","red","blue")) + guides(colour="none", size="none")
ggplot(.data) + geom_line(aes(x=Time, y=value, group=variable, colour=colour, size=width)) +
scale_colour_manual(values=c("black","red","blue")) + guides(colour="none", size="none") +
scale_size_manual(values=c(1,1.5))
str(.data)
.data$width <- factor(.data$width)
ggplot(.data) + geom_line(aes(x=Time, y=value, group=variable, colour=colour, size=width)) +
scale_colour_manual(values=c("black","red","blue")) + guides(colour="none", size="none") +
scale_size_manual(values=c(1,1.5))
ggpl <- function(.data, .indices){
.data <- as.data.frame(.data)
colnames(.data) <- 1:ncol(.data)
.data$Time <- 1:nrow(.data)
.data <- melt(.data, id="Time")
.data$colour <- 'black'
.data$colour[.data$variable %in% .indices$leftInd] <- "red"
.data$colour[.data$variable %in% .indices$rightInd] <- "blue"
.data$colour <- factor(.data$colour, levels=c("black","red","blue"))
.order <- c(.data$variable[.data$colour=="black"], .data$variable[.data$colour=="red"],.data$variable[.data$colour=="blue"])
.data$variable <- factor(.data$variable, levels = .order)
.data$width <- 1.5
.data$width[.data$colour=="black"] <- 1
.data$width <- factor(.data$width)
pl <- ggplot(.data) + geom_line(aes(x=Time, y=value, group=variable, colour=colour, size=width)) +
scale_colour_manual(values=c("black","red","blue")) + guides(colour="none", size="none") +
scale_size_manual(values=c(1,1.5))
return(pl)
}
node = "0"
png(paste("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/img/splitting_", node,".png", sep=""),
units="in", res=300, width = 12, height=6)
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
node = "0l"
png(paste("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/img/splitting_", node,".png", sep=""),
units="in", res=300, width = 12, height=6)
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
node = "0ll"
png(paste("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/img/splitting_", node,".png", sep=""),
units="in", res=300, width = 12, height=6)
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
node = "0lll"
png(paste("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/img/splitting_", node,".png", sep=""),
units="in", res=300, width = 12, height=6)
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
node = "0lllr"
png(paste("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/img/splitting_", node,".png", sep=""),
units="in", res=300, width = 12, height=6)
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
node = "0lllrr"
png(paste("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/img/splitting_", node,".png", sep=""),
units="in", res=300, width = 12, height=6)
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
node = "0lr"
png(paste("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/img/splitting_", node,".png", sep=""),
units="in", res=300, width = 12, height=6)
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
node = "0lrr"
png(paste("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/img/splitting_", node,".png", sep=""),
units="in", res=300, width = 12, height=6)
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
ggpl <- function(.data, .indices){
.data <- as.data.frame(.data)
colnames(.data) <- 1:ncol(.data)
.data$Time <- 1:nrow(.data)
.data <- melt(.data, id="Time")
.data$colour <- 'black'
.data$colour[.data$variable %in% .indices$leftInd] <- "red"
.data$colour[.data$variable %in% .indices$rightInd] <- "blue"
.data$colour <- factor(.data$colour, levels=c("black","red","blue"))
.order <- c(.data$variable[.data$colour=="black"], .data$variable[.data$colour=="red"],.data$variable[.data$colour=="blue"])
.data$variable <- factor(.data$variable, levels = .order)
.data$width <- 1.5
.data$width[.data$colour=="black"] <- 1
.data$width <- factor(.data$width)
pl <- ggplot(.data) + geom_line(aes(x=Time, y=value, group=variable, colour=colour, size=width), alpha=0.6) +
scale_colour_manual(values=c("black","red","blue")) + guides(colour="none", size="none") +
scale_size_manual(values=c(1,1.2))
return(pl)
}
node = "0"
png(paste("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/img/splitting_", node,".png", sep=""),
units="in", res=300, width = 12, height=6)
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
node = "0l"
png(paste("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/img/splitting_", node,".png", sep=""),
units="in", res=300, width = 12, height=6)
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
node = "0lr"
png(paste("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/img/splitting_", node,".png", sep=""),
units="in", res=300, width = 12, height=6)
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
node = "0lrr"
png(paste("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/img/splitting_", node,".png", sep=""),
units="in", res=300, width = 12, height=6)
pTree <- plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .node = node, .round=2, .ggReturn = TRUE)
indices <- getIndices(mvTree.dist$trees[[1]], node)
pOil <- ggpl(oilRatesFinal, indices) + xlab("Time (days)") + ylab("STB/day")
pGas <- ggpl(gasRatesFinal, indices) + xlab("Time (days)") + ylab("MMSCF/day")
multiPlot(pTree, pOil, pGas, cols=3, layout=matrix(c(1,1,1,1,2,3), 2, 3))
dev.off()
plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .round=2)
plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .round=2)
plotFtree(mvTree.dist, .horizontal = TRUE, .ylimLow = -1, .labSize = 3.6, .round=2)
library(knitr)
library(fTree)
library(ggplot2)
library(functInterp)
library(plyr)
load("~/Google Drive/Functional_Research/PhD_Dissertation/Functional_Interpolation_Multivariate/forVignette.RData")
fTree.sse <- ftree(.X = WELL_PARAMETERS[train,], .Y=OIL[,train], cost.type = 'sse', tree.type = 'single')
train=1:100
fTree.sse <- ftree(.X = WELL_PARAMETERS[train,], .Y=OIL[,train], cost.type = 'sse', tree.type = 'single')
node = "0ll"
plotFtree(fTree.sse, .labSize = 2, .horizontal = T, .ylimLow = -1, .node = node)
indices <- getNodeIndices(fTree.sse$trees[[1]], node)
matplot(OIL[,train], type="l", col="black", lty=1, xlab="Time (days)", ylab="STB/day")
matplot(OIL[,train][,indices$rightInd], col="blue", lty=1, add=TRUE)
node = "0ll"
plotFtree(fTree.sse, .labSize = 2, .horizontal = T, .ylimLow = -1, .node = node)
indices <- getNodeIndices(fTree.sse$trees[[1]], node)
matplot(OIL[,train], type="l", col="black", lty=1, xlab="Time (days)", ylab="STB/day")
matplot(OIL[,train][,indices$rightInd], type = "l", col="blue", lty=1, add=TRUE)
matplot(OIL[,train][,indices$leftInd], type = "l", col="red", lty=1, add=TRUE)
node = "0ll"
plotFtree(fTree.sse, .labSize = 2, .horizontal = T, .ylimLow = -1, .node = node)
indices <- getNodeIndices(fTree.sse$trees[[1]], node)
matplot(OIL[,train], type="l", col="black", lty=1, xlab="Time (days)", ylab="STB/day")
matplot(OIL[,train][,indices$rightInd], type = "l", col="blue", lty=1, add=TRUE)
fTree.rdistOG.predictO <- predictFtree(fTree.rdistOG, .Xnew = WELL_PARAMETERS[-train,])
fTree.rdistOG.Gas <- fTree.rdistOG
fTree.rdistOG.Gas$functions <- GAS[,train]
fTree.rdistOG.predictG <- predictFtree(fTree.rdistOG.Gas, .Xnew = WELL_PARAMETERS[-train,])
fTree.rdistO <- ftree(.X = WELL_PARAMETERS[train,], .Y=OIL[,train], .D = "euclidean", cost.type = 'rdist', tree.type = 'single')
D.oil = as.matrix(dist(t(OIL[,train])), "euclidean")
D.gas = as.matrix(dist(t(GAS[,train])), "euclidean")
D.oil = D.oil/max(D.oil)
D.gas = D.gas/max(D.gas)
fTree.rdistOG <- ftree(.X = WELL_PARAMETERS[train,], .Y=OIL[,train], .D = D.oil + D.gas, cost.type = 'rdist', tree.type = 'single')
fTree.rdistOG.predictO <- predictFtree(fTree.rdistOG, .Xnew = WELL_PARAMETERS[-train,])
fTree.rdistOG.Gas <- fTree.rdistOG
fTree.rdistOG.Gas$functions <- GAS[,train]
fTree.rdistOG.predictG <- predictFtree(fTree.rdistOG.Gas, .Xnew = WELL_PARAMETERS[-train,])
fTree.rdistOG.Gas
fTree.rdistOG.predictG
fTree.rdistOG.predictG[1]
plot(fTree.rdistOG.predictG[1])
fTree.rdistOG.predictG[1]
fTree.rdistOG.predictG$Well_101[1,]
plot(fTree.rdistOG.predictG$Well_101[1,])
plot(t(fTree.rdistOG.predictG$Well_101[1,]))
matplot(GAS, type="l", lty=1)
for(i in 1:4){
plot(OIL[,-train][,i], xlab="Time(days)", ylab="STB/day", type="l", col="black")
lines(t(fTree.rdistOG.predictO[[i]]), col="blue")
plot(GAS[,-train][,i], xlab="Time(days)", ylab="MSCF/day", type="l", col="black")
lines(t(fTree.rdistOG.predictG[[i]]), col="red")
}
par(mfrow=c(4,2))
for(i in 1:4){
plot(OIL[,-train][,i], xlab="Time(days)", ylab="STB/day", type="l", col="black", ylim=c(0,700))
lines(t(fTree.rdistOG.predictO[[i]]), col="blue")
plot(GAS[,-train][,i], xlab="Time(days)", ylab="MSCF/day", type="l", col="black", ylim=c(0,1600))
lines(t(fTree.rdistOG.predictG[[i]]), col="red")
}
par(mfrow=c(4,2))
for(i in 1:4){
plot(OIL[,-train][,i], xlab="Time(days)", ylab="STB/day", type="l", col="black", ylim=c(0,700))
lines(t(fTree.rdistOG.predictO[[i]]), col="blue")
plot(GAS[,-train][,i], xlab="Time(days)", ylab="MSCF/day", type="l", col="black", ylim=c(0,1600))
lines(t(fTree.rdistOG.predictG[[i]]), col="red")
}
par(mfrow=c(4,2))
par(mar=c(4,4,1,1)+0.1)
for(i in 1:4){
plot(OIL[,-train][,i], xlab="Time(days)", ylab="STB/day", type="l", col="black", ylim=c(0,700))
lines(t(fTree.rdistOG.predictO[[i]]), col="blue")
plot(GAS[,-train][,i], xlab="Time(days)", ylab="MSCF/day", type="l", col="black", ylim=c(0,1600))
lines(t(fTree.rdistOG.predictG[[i]]), col="red")
}
debug(ftree)
fTree.rdistO <- ftree(.X = WELL_PARAMETERS[train,], .Y=OIL[,train], .D = D, cost.type = 'rdist', tree.type = 'randomforest', nBoot = 200)
D
D.oil = as.matrix(dist(t(OIL[,train])), "euclidean")
D.gas = as.matrix(dist(t(GAS[,train])), "euclidean")
D.oil = D.oil/max(D.oil)
D.gas = D.gas/max(D.gas)
fTree.rdistO <- ftree(.X = WELL_PARAMETERS[train,], .Y=OIL[,train], .D = D.oil, cost.type = 'rdist', tree.type = 'randomforest', nBoot = 200)
library(fTree)
